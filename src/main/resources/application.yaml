spring:
  config:
    import: optional:file:config/secrets.properties,optional:file:config/secrets.yaml
  application:
    name: finguard
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:finguard}
    username: ${DB_USER:finguard}
    password: ${DB_PASSWORD:finguard}
  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: UTC
    show-sql: false
    open-in-view: false
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      probes:
        enabled: true

app:
  frontend:
    base-url: ${APP_FRONTEND_BASE_URL:http://localhost:8080}
  mail:
    enabled: ${MAIL_ENABLED:false}
    from: ${MAIL_FROM:no-reply@finguard.local}
    reset-subject: ${MAIL_RESET_SUBJECT:Сброс пароля FinGuard}
    verify-subject: ${MAIL_VERIFY_SUBJECT:Подтверждение email FinGuard}
    otp-subject: ${MAIL_OTP_SUBJECT:Код входа FinGuard}
  security:
    csrf:
      enabled: ${CSRF_ENABLED:true}
    jwt:
      secret: ${JWT_SECRET:}
      expiration-seconds: ${JWT_EXPIRATION:3600}
      refresh-expiration-seconds: ${JWT_REFRESH_EXPIRATION:604800}
      issuer: ${JWT_ISSUER:finguard}
      audience: ${JWT_AUDIENCE:finguard-app}
      require-env-secret: ${JWT_REQUIRE_ENV_SECRET:true}
      cookie-secure: ${JWT_COOKIE_SECURE:false}
      cookie-samesite: ${JWT_COOKIE_SAMESITE:Strict}
    otp:
      enabled: ${OTP_ENABLED:true}
      ttl-seconds: ${OTP_TTL_SECONDS:300}
      max-attempts: ${OTP_MAX_ATTEMPTS:5}
      max-entries: ${OTP_MAX_ENTRIES:10000}
    cors:
      allowed-origins: ${ALLOWED_ORIGINS:}
    rate-limit:
      max-entries: ${RATE_LIMIT_MAX_ENTRIES:10000}
      auth:
        limit: ${RATE_LIMIT_AUTH_LIMIT:60}
        window-ms: ${RATE_LIMIT_AUTH_WINDOW_MS:60000}
      forgot:
        limit: ${RATE_LIMIT_FORGOT_LIMIT:8}
        window-ms: ${RATE_LIMIT_FORGOT_WINDOW_MS:300000}
      verify:
        limit: ${RATE_LIMIT_VERIFY_LIMIT:8}
        window-ms: ${RATE_LIMIT_VERIFY_WINDOW_MS:300000}
      reset-confirm:
        limit: ${RATE_LIMIT_RESET_CONFIRM_LIMIT:5}
        window-ms: ${RATE_LIMIT_RESET_CONFIRM_WINDOW_MS:300000}
      reset:
        limit: ${RATE_LIMIT_RESET_LIMIT:5}
        window-ms: ${RATE_LIMIT_RESET_WINDOW_MS:300000}
      register-ip:
        limit: ${RATE_LIMIT_REGISTER_IP_LIMIT:20}
        window-ms: ${RATE_LIMIT_REGISTER_IP_WINDOW_MS:300000}
      register-email:
        limit: ${RATE_LIMIT_REGISTER_EMAIL_LIMIT:10}
        window-ms: ${RATE_LIMIT_REGISTER_EMAIL_WINDOW_MS:300000}
      login-otp:
        limit: ${RATE_LIMIT_LOGIN_OTP_LIMIT:6}
        window-ms: ${RATE_LIMIT_LOGIN_OTP_WINDOW_MS:180000}
      login-otp-issue:
        limit: ${RATE_LIMIT_LOGIN_OTP_ISSUE_LIMIT:3}
        window-ms: ${RATE_LIMIT_LOGIN_OTP_ISSUE_WINDOW_MS:60000}
      login-email:
        limit: ${RATE_LIMIT_LOGIN_EMAIL_LIMIT:8}
        window-ms: ${RATE_LIMIT_LOGIN_EMAIL_WINDOW_MS:300000}
    tokens:
      reset-cooldown-seconds: ${RESET_COOLDOWN_SECONDS:60}
      reset-session-ttl-minutes: ${RESET_SESSION_TTL_MINUTES:15}
