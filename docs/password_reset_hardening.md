# Password Reset Hardening

## Реализовано
- [x] Серверный rate limit подтверждения кода `/api/auth/reset/confirm` по email и IP: при превышении отдаем 429/100005, инвалидируем активные коды и требуем новый.
- [x] resetSessionToken одноразовый: успешный reset мгновенно помечает код использованным, съедает reset-сессию и чистит другие reset-коды.
- [x] `/api/auth/forgot` всегда отвечает одинаково («If this email exists…»), без утечек о валидности email.
- [x] resetSessionToken в БД хранится только в виде SHA-256 хеша; сырой токен известен лишь пользователю.
- [x] Смена пароля ревокирует все refresh/access-сессии пользователя.
- [x] Soft-привязка resetSessionToken к IP/UA: записываем хеши IP/UA, логируем несоответствия, при полном расхождении блокируем.
- [x] Разведены сообщения: неверный код vs истекший/потребовавший новый.
